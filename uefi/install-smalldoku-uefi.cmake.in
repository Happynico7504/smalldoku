set(FILE_TO_INSTALL "@UEFI_INSTALL_FILE_TO_INSTALL@")
set(EFI_VOLUME "@UEFI_INSTALL_EFI_VOLUME@")

set(EFI_ENTRY_PATH "EFI/Smalldoku")
set(EFI_FILE_NAME "Smalldoku.efi")
set(EFI_ENTRY_FILE "${EFI_ENTRY_PATH}/${EFI_FILE_NAME}")

string(REPLACE "/" "\\" EFI_ENTRY_VALUE "/${EFI_ENTRY_FILE}")
set(TARGET_DIRECTORY "${EFI_VOLUME}/${EFI_ENTRY_PATH}")

set(TARGET_FILE "${TARGET_DIRECTORY}/${EFI_FILE_NAME}")
message(STATUS "Installing ${FILE_TO_INSTALL} to ${TARGET_FILE}")

file(MAKE_DIRECTORY "${TARGET_DIRECTORY}")
configure_file("${FILE_TO_INSTALL}" "${TARGET_FILE}" COPYONLY)

message(STATUS "File copied to ${TARGET_FILE}, the new UEFI boot entry should be '${EFI_ENTRY_VALUE}'")
